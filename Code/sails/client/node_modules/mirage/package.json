{
  "_args": [
    [
      {
        "raw": "mirage@0.0.6",
        "scope": null,
        "escapedName": "mirage",
        "name": "mirage",
        "rawSpec": "0.0.6",
        "spec": "0.0.6",
        "type": "version"
      },
      "/home/mshanahan906/coursenebula/Code/sails/emberApp"
    ]
  ],
  "_from": "mirage@0.0.6",
  "_id": "mirage@0.0.6",
  "_inCache": true,
  "_location": "/mirage",
  "_nodeVersion": "6.2.0",
  "_npmOperationalInternal": {
    "host": "packages-16-east.internal.npmjs.com",
    "tmp": "tmp/mirage-0.0.6.tgz_1463990415945_0.20753698982298374"
  },
  "_npmUser": {
    "name": "lpinca",
    "email": "luigipinca@gmail.com"
  },
  "_npmVersion": "3.8.9",
  "_phantomChildren": {},
  "_requested": {
    "raw": "mirage@0.0.6",
    "scope": null,
    "escapedName": "mirage",
    "name": "mirage",
    "rawSpec": "0.0.6",
    "spec": "0.0.6",
    "type": "version"
  },
  "_requiredBy": [
    "#DEV:/"
  ],
  "_resolved": "http://registry.npmjs.org/mirage/-/mirage-0.0.6.tgz",
  "_shasum": "694de07749efcc634b7f2c50172c7a56c49976b2",
  "_shrinkwrap": null,
  "_spec": "mirage@0.0.6",
  "_where": "/home/mshanahan906/coursenebula/Code/sails/emberApp",
  "author": {
    "name": "Arnout Kazemier"
  },
  "bugs": {
    "url": "https://github.com/primus/mirage/issues"
  },
  "dependencies": {
    "diagnostics": "1.0.x",
    "one-time": "0.0.x"
  },
  "description": "Custom session id syncing and validation",
  "devDependencies": {
    "assume": "1.4.x",
    "mocha": "2.4.x",
    "pre-commit": "1.1.x",
    "primus": "5.2.x",
    "primus-emit": "1.0.x",
    "ws": "1.1.x"
  },
  "directories": {},
  "dist": {
    "shasum": "694de07749efcc634b7f2c50172c7a56c49976b2",
    "tarball": "https://registry.npmjs.org/mirage/-/mirage-0.0.6.tgz"
  },
  "gitHead": "6df8e258457ba43c6a3b61374bfe60c4af5131a1",
  "homepage": "https://github.com/primus/mirage",
  "keywords": [
    "primus",
    "mirage",
    "persistent",
    "session",
    "id"
  ],
  "license": "MIT",
  "main": "index.js",
  "maintainers": [
    {
      "name": "v1",
      "email": "npm@3rd-Eden.com"
    },
    {
      "name": "3rdeden",
      "email": "npm@3rd-Eden.com"
    },
    {
      "name": "lpinca",
      "email": "luigipinca@gmail.com"
    }
  ],
  "name": "mirage",
  "optionalDependencies": {},
  "readme": "# Mirage\n\n[![Version npm](http://img.shields.io/npm/v/mirage.svg?style=flat-square)](http://browsenpm.org/package/mirage)[![Build Status](http://img.shields.io/travis/primus/mirage/master.svg?style=flat-square)](https://travis-ci.org/primus/mirage)[![Dependencies](https://img.shields.io/david/primus/mirage.svg?style=flat-square)](https://david-dm.org/primus/mirage)[![Coverage Status](http://img.shields.io/coveralls/primus/mirage/master.svg?style=flat-square)](https://coveralls.io/r/primus/mirage?branch=master)[![IRC channel](http://img.shields.io/badge/IRC-irc.freenode.net%23primus-00a8ff.svg?style=flat-square)](http://webchat.freenode.net/?channels=primus)\n\nSome might say that Mirage was created with a silver sparkplug in his mouth. On\nCybertron, he was one of the planet's elite upper class, preferring to spend his\ndays hunting turbo-foxes instead of involving himself in conflict. He is armed\nwith a rifle which fires explosive, armor-piercing darts, but the most important\npiece of his arsenal in his function as a spy is his shoulder-mounted\nelectro-disruptor, which can bend photons to make Mirage invisible, or appear to\nbe where he is not, or even alter his physical appearance, hence his name.\n\nHis invisibility is invaluable for Primus. He now spends his time validating and\ngenerating session ids without the user even know it's there. It's a fully\ntransparent process, it's invisible, it's Mirage. The generated session ids can\nbe persisted if needed.\n\n## Installation\n\nThis is a plugin for the Primus framework and can be installed using `npm`:\n\n```\nnpm install --save mirage\n```\n\nThe `--save` tells `npm` to automatically add the installed version to your\npackage.json.\n\nThis module assumes that you're using either the [`primus-emit`](https://github.com/primus/emit)\nor the [`primus-emitter`](https://github.com/cayasso/primus-emitter) module,\nfor emitting events. Please see their sites to get detailed installation\ninstructions.\n\n## Table of Contents\n\n- [Usage server](#usage-server)\n  - [primus.id.timeout](#primusidtimeout)\n  - [primus.id.generator](#primusidgenerator)\n  - [primus.id.validator](#primusidvalidator)\n- [Usage client](#usage-client)\n\n## Usage server\n\nThe `mirage` plugin should be the first plugin you load in Primus. This is\nbecause it will buffer incoming messages while it's validating or generating\nan id. If you don't do this, **you will experience loss of data/messages!**.\nEven the [`fortess-maximus`](https://github.com/primus/fortress-maximus) plugin,\nthat is generally added as the first plugin, should be loaded after `mirage`.\n\nTo add this plugin to your Primus server simply call the `.use` method on the\nPrimus instance:\n\n```js\nprimus.use('mirage', require('mirage'));\n```\n\nNow that you've added the plugin, a new object, `.id` is available on your Primus\ninstance. This object allows you to interact with the `mirage` plugin.\n\n### primus.id.timeout\n\nThe maximum time it should take to validate or generate a session id. If\na timeout occurs all messages will be flushed and the callback will be called\nwith an error. You can assign the timeout directly using:\n\n```js\nprimus.id.timeout = 2000;\n```\n\nIt's also possible to configure this value using the `mirage timeout` option\nin the Primus constructor:\n\n```js\nvar primus = new Primus(httpsserver, {\n  'transformer': 'engine.io',\n  'mirage timeout': 5000\n});\n```\n\n### primus.id.generator\n\nThe generator method allows you to assign a custom id generator. By default we\ngenerate 8 random bytes using the `crypto` module. To set your own generator\nsimply call the `primus.id.generator` with the function that you want to use.\n\nThe supplied function will receive 2 arguments:\n\n1. `spark` A reference to the spark instance that is attempting to connect to\n   your server.\n2. `function` An error first callback which assumes to receive an error as first\n   argument if generation failed and the generated id as second argument.\n\n```js\nprimus.id.generator(function generate(spark, fn) {\n  asyncLookup(spark.query.customquerystring, function (err, account) {\n    if (err) return fn(err);\n\n    fn(undefined, account._id);\n  });\n});\n```\n\n### primus.id.validator\n\nThe validator method is called when we receive a pre-defined id. By default\nwe just allow all the things, but this can be overridden by supplying the\n`primus.id.validator` with a custom validator function.\n\nThe supplied function will receive 2 arguments:\n\n1. `spark` A reference to the spark instance that is attempting to connect to\n  your server.\n2. `function` An error first callback. If you fail to validate the id, we assume\n  that you pass this function an `Error` instance as first argument.\n\n```js\nprimus.id.validator(function validator(spark, fn) {\n  accountdb.exists(spark.mirage, function (err, exists) {\n    if (!err && !exists) err = new Error('Invalid id');\n\n    fn(err);\n  });\n});\n```\n\nAs you can see in the example above, the mirage `id` is introduced on the spark\nas `spark.mirage`. You can use this id to validate the connection. Now there are\ncases where you don't want to end the connection by supplying the callback with\nan error but you actually want to re-set a new session id. Well that's also\npossible with the validator as it can also act as a generator. To generate a\nnew session id you can call the callback with the new id as the second argument:\n\n```js\nprimus.id.validator(function validate(spark, fn) {\n  if (spark.mirage === 'old') return fn(undefined, 'new');\n  if (spark.mirage === 'new') return fn(undefined, 'old');\n\n  fn(new Error('The id is neither new or old'));\n});\n```\n\n## Usage client\n\nThe plugin also ships with a client API. This client API can be used for\npersisting the sessions across reconnects, refreshes and more. To re-use an id\nsimply add the `mirage` option in the client when connecting.\n\n```js\nvar socket = new Primus('https://example.org', {\n  mirage: readcookie('sessionid')\n});\n```\n\nWhen you receive a new session id from the server we emit a `mirage` event:\n\n```js\nsocket.on('mirage', function (id) {\n  savecookie('sessionid', id);\n});\n```\n\nThe id is also always available at: `socket.mirage`, but this is only after the\nconnection has generated an id or if you've manually supplied it.\n\n## License\n\nMIT\n",
  "readmeFilename": "README.md",
  "repository": {
    "type": "git",
    "url": "git+https://github.com/primus/mirage.git"
  },
  "scripts": {
    "test": "mocha"
  },
  "version": "0.0.6"
}
